<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../marked-element/marked-element.html">
<link rel="import" href="../prism-element/prism-theme-default.html">
<link rel="import" href="../prism-element/prism-highlighter.html">
<link rel="import" href="../iron-pages/iron-pages.html">
<link rel="import" href="../iron-collapse/iron-collapse.html">
<link rel="import" href="../paper-tabs/paper-tabs.html">
<link rel="import" href="../paper-tabs/paper-tab.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="docs-parameters-behavior.html">
<link rel="import" href="docs-parameters-table-shared-styles.html">
<link rel="import" href="structure-display.html">
<link rel="import" href="example-display.html">

</head><body><dom-module id="docs-json-parameters-table">
  <template>
    <style include="prism-theme-default"></style>
    <style include="docs-parameters-table-shared-styles"></style>
    <style>
    :host {
      --paper-tabs-selection-bar-color: var(--params-table-header-background-color, #00A1DF);
      --paper-tab-ink: var(--params-table-header-background-color, #00A1DF);
    }

    .parent-prefix {
      color: var(--params-table-subproperty-prefix-color, rgba(0, 0, 0, 0.54));
    }

    .parent-prefix::after {
      content: '.';
    }

    paper-listbox paper-item {
      cursor: pointer;
    }

    .no-type {
      @apply(--no-info-message);
    }

    </style>
    <prism-highlighter></prism-highlighter>

    <p class="no-type" hidden$="[[!_computeIsTypeVisible(hasExamples, hasType)]]">
      This object doesn't have a type description.
    </p>

    <div id="content" hidden$="[[_computeIsTypeVisible(hasExamples, hasType)]]">
      <template is="dom-if" if="[[_displayTypeOnly(hasType, hasExamples)]]" restamp="true">
        <iron-collapse opened="[[structureDisplayOpened]]">
          <div>
            <pre is="structure-display" display="[[displayJson]]" class="language-javascript" auto-hide=""></pre>
          </div>
        </iron-collapse>
      </template>
      <template is="dom-if" if="[[_displayExampleOnly(hasType, hasExamples)]]" restamp="true">
        <iron-collapse opened="[[structureDisplayOpened]]">
          <div class="examples">
            <template is="dom-repeat" items="[[examples]]">
              <example-display is-json="" content="[[item]]"></example-display>
            </template>
          </div>
        </iron-collapse>
      </template>
      <template is="dom-if" if="[[_displayTypeAndExample(hasType, hasExamples)]]" restamp="true">
        <iron-collapse opened="[[structureDisplayOpened]]">
          <div>
            <paper-tabs class="schemas" selected="{{selectedSchemaPage}}">
              <paper-tab>[[_getTypeTabName(isSchema)]]</paper-tab>
              <paper-tab>Examples</paper-tab>
            </paper-tabs>
            <iron-pages selected="{{selectedSchemaPage}}">
              <div class="schema">
                <h5 hidden$="[[!type.schema]]">Schema: [[type.schema]]</h5>
                <pre is="structure-display" display="[[displayJson]]" class="language-javascript" auto-hide=""></pre>
              </div>
              <div class="examples">
                <template is="dom-repeat" items="[[examples]]">
                  <example-display is-json="" content="[[item]]"></example-display>
                </template>
              </div>
            </iron-pages>
          </div>
        </iron-collapse>
      </template>
      <h5 class="narrow-title">Properties</h5><table class="params-table" hidden$="[[_parametersTableHidden(isSchema, hasType)]]">
        <thead class="params-table-header">
          <tr>
            <th>Parameter</th>
            <th>Type</th>
            <th>Description</th>
          </tr>
        </thead>
        
        <tbody id="tableContent"></tbody>
      </table>
    </div>
  </template>
  <script>Polymer({is:"docs-json-parameters-table",behaviors:[RamlBehaviors.DocsParametersBehavior],properties:{type:Object,hasType:{type:Boolean,computed:"_computeHasType(type.*)",value:!1,notify:!0},displayJson:{type:String,computed:"_computeDisplayJson(type.*)"},examples:{type:Array,computed:"_computeExamples(type.*)"},selectedSchemaPage:{type:Number,value:0},isSchema:Boolean,structureDisplayOpened:{type:Boolean,value:!0},narrow:{type:Boolean,reflectToAttribute:!0}},observers:["_computeHTML(hasType, type.*)","_updateTabs(hasExamples)"],listeners:{"content.iron-select":"_typeDropdownChanged","content.iron-deselect":"_typeDropdownChanged"},_computeHasType:function(e){if(!e.base)return this.isSchema=!1,!1;var t=e.base;if(t.schema)return this.isSchema=!0,!!t.schemaContent;if(this.isSchema=!1,"array"===t.type)return!!t.items;if("union"===t.type)return!(!t.anyOf||!t.anyOf.length);if("json"===t.type)return this.isSchema=!0,!!t.content;var a=!(!t.properties||!Object.keys(t.properties).length);return a},_computeDisplayJson:function(e){if(e&&e.base){if(e.base.schema)return e.base.schemaContent;if(e.base.type instanceof Array&&(e.base.type=e.base.type[0]),"json"===e.base.type)return e.base.content;var t=e.base.properties,a=!1,r=!(!t||!Object.keys(t).length);if(!r)if("array"===e.base.type)t=e.base.items.properties,a=!0,r=!(!t||!Object.keys(t).length);else if("union"!==e.base.type)return;var n=r?this.__transformObject({},t):{},s=this;if("union"===e.base.type){var p=[];e.base.anyOf.forEach(function(e){var t=s.__transformObject({},e.properties,!0);p[p.length]=t}),n=Object.assign(n,p[0])}return a&&(n=[n]),JSON.stringify(n,null,2)}},_computeHasExample:function(){var e=this.type;return!!e&&(!e.examples&&e.example&&(e.examples=[e.example]),!!(e.structuredExample||e.examples&&e.examples.length))},__transformObject:function(e,t){for(var a=this.baseTypes,r=0,n=t.length;r<n;r++){var s,p=t[r],i=p.type;i instanceof Array&&(i=i[0],t.type=i),a.indexOf(i)===-1?s=p.properties?this.__transformObject({},this.readProperties(p.properties)):i:"object"===i&&p.properties?s=this.__transformObject({},this.readProperties(p.properties)):"array"===i?(p.items.type instanceof Array&&(p.items.type=p.items.type[0]),s="object"===p.items.type?[this.__transformObject({},this.readProperties(p.items.properties))]:[p.items.type]):s=i,e[p.key]=s}return e},_getSubproperties:function(e){if(e)return"array"===e.type?e.items.properties:"union"===e.type?e.properties.concat(e.anyOf):e.properties},_computeHTML:function(e){e&&this.type&&(this.$$("#tableContent").innerHTML="",this.debounce("body-params-table-render",function(){this.$$("#tableContent").innerHTML="",this.__computeHtml(this.type)}.bind(this),100))},__computeUnionTypes:function(e){var t={};if(e.anyOf&&e.anyOf.length)for(var a=0,r=e.anyOf.length;a<r;a++)for(var n=0,s=e.anyOf[a].properties.length;n<s;n++)e.anyOf[a].properties[n].name in t||(t[e.anyOf[a].properties[n].name]=!0);return Object.keys(t)},__computeHtml:function(e,t){if(e){t=t||{};var a,r,n,s,p,i=this.$$("#tableContent");if(this.baseTypes.indexOf(e.type)!==-1&&"object"!==e.type&&"array"!==e.type)return a=this.__createRowForItem(e,t),void i.appendChild(a);if(e.properties&&e.properties.length)for(r=0,n=e.properties.length;r<n;r++)s=e.properties[r],this.__handleHtmlDocProperty(s,t);if(e.items&&e.items.properties&&e.items.properties.length)for(a=this.__createRowForItem(e,t),i.appendChild(a),p=Object.assign({},t,{parent:e}),r=0,n=e.items.properties.length;r<n;r++)s=e.items.properties[r],this.__handleHtmlDocProperty(s,p);if("union"===e.type){if(!e.anyOf.length)return;for(a=this.__createRowForUnion(e.anyOf.length),i.appendChild(a),r=0,n=e.anyOf.length;r<n;r++)for(var o=0,l=e.anyOf[r].properties.length;o<l;o++)s=e.anyOf[r].properties[o],p={inUnion:!0,parent:t.parent||e,variantIndex:r,childIndex:o},this.__handleHtmlDocProperty(s,p)}}},__handleHtmlDocProperty:function(e,t){t=t||{};var a=!1;(e.properties||e.items)&&(a=!0);var r,n=this.__createRowForItem(e,t);if(this.$$("#tableContent").appendChild(n),a){var s=e.properties||e.items.properties||e.items;if(s instanceof Array)for(var p=0,i=s.length;p<i;p++)r=Object.assign({},t,{parent:e,hasChildren:a}),this.__computeHtml(s[p],r);else if("string"==typeof s);else{if("any"===s.type&&!s.enum)return;s.name!==(e.name||e.key)&&(r=Object.assign({},t,{parent:e,hasChildren:a}),this.__computeHtml(s,r))}}},__createRowForItem:function(e,t){if(t=t||{},"string"!=typeof e){var a=function(e){return document.createElement(e)},r=a("tr"),n=a("td"),s=a("td"),p=a("td"),i=a("span"),o="style-scope docs-json-parameters-table";r.className=o,n.className=o+" param-name",s.className=o+" param-type",p.className=o+" param-desc",i.className=o+" display";var l=!0;if(t.inUnion&&(r.dataset.parent=t.variantIndex,r.setAttribute("hidden",!0),t.parent.anyOf&&(i.textContent=e.key,l=!1)),t.parent){if(l){n.className+=" subproperty",i.className+=" child";var m=a("span"),c=a("span");m.className=o+" parent-prefix",m.textContent=t.parent.displayName||t.parent.name||t.parent.key,c.textContent=e.key||e.name||e.displayName,i.appendChild(m),i.appendChild(c),r.className+=" subproperty"}}else i.textContent=e.key;if(t.hasChildren&&(r.className+=" has-children"),"array"===e.type){var d="";d+=e.items.properties&&e.items.displayName?e.items.displayName+"["+e.items.type+"]":"Array["+e.items.type+"]",s.textContent=d}else"any"===e.type&&e.enum?s.textContent="Enum":s.textContent="object"===e.type?e.displayName||e.type:e.type;if(e.description){var y=a("marked-element"),h=a("div");y.className=o+"",y.setAttribute("smartypants",!0),y.addEventListener("marked-render-complete",this._markedRendered.bind(this)),h.className=o+" markdown-html markdown-body",y.appendChild(h),p.appendChild(y),y.markdown=e.description}if(e.pattern){var u=this.__createCellProperty("pattern","Validation pattern:",e.pattern);p.appendChild(u)}if(e.example){var f=this.__createCellProperty("example","Example:",e.example);p.appendChild(f)}if(e.min||0===e.min){var b=this.__createCellProperty("min","Minimum value:",e.min);p.appendChild(b)}if(e.max||0===e.max){var _=this.__createCellProperty("max","Maximum value:",e.max);p.appendChild(_)}if(e.enum&&e.enum.length){var v=this.__createCellProperty("enum","Possible values:",this._computeEnumValue(e.enum));p.appendChild(v)}if(n.appendChild(i),e.required){var C=a("span");C.textContent="*",C.title=i.title="Required property",n.appendChild(C)}return r.appendChild(n),r.appendChild(s),r.appendChild(p),r}},__createRowForUnion:function(e){if(!e)return console.warn("Trying to invoke row for union but number is not set");var t=function(e){return document.createElement(e)},a=t("tr"),r=t("td"),n=t("td"),s=t("td"),p=t("span"),i="style-scope docs-json-parameters-table";a.className=i,r.className=i+" param-name",n.className=i+" param-type",s.className=i+" param-desc",p.className=i+" display",p.textContent="Type variant";var o='<paper-dropdown-menu no-label-float class="'+i+'">';o+='<paper-listbox class="'+i+' dropdown-content" selected="0" data-action="toggle-type">';for(var l=0;l<e;l++)o+='<paper-item data-type="'+l+'" class="'+i+'">Variant '+(l+1)+"</paper-item>";return n.innerHTML=o,a.appendChild(r),a.appendChild(n),a.appendChild(s),a},__createCellProperty:function(e,t,a){var r=document.createElement("div");r.className="style-scope docs-json-parameters-table "+e;var n=document.createElement("span"),s=document.createElement("span");return n.className="style-scope docs-json-parameters-table display",s.className="style-scope docs-json-parameters-table value",n.textContent=t,s.textContent=a,r.appendChild(n),r.appendChild(s),r},_typeDropdownChanged:function(e){var t=e.target;if(t&&t.dataset&&t.dataset.action)switch(t.dataset.action){case"toggle-type":this._toggleType(e.detail.item.dataset.type,"iron-select"===e.type)}},_toggleType:function(e,t){e&&Polymer.dom(this.$$("#tableContent")).querySelectorAll('[data-parent="'+e+'"]').forEach(function(e){t?e.removeAttribute("hidden"):e.setAttribute("hidden",!0)})},_markedRendered:function(e){e=Polymer.dom(e);var t=e.rootTarget,a=t.querySelector("p");if(a){a.className+=" docs-json-parameters-table";var r=t.querySelector("#content");r&&(r.className+=" markdown-html markdown-body docs-json-parameters-table")}},_updateTabs:function(e){if(e){var t=this.$$("paper-tabs");t&&t.notifyResize()}},_getTypeTabName:function(e){return e?"Schema":"Type"},_computeIsTypeVisible:function(e,t){return!(e||t)},_displayExampleOnly:function(e,t){return!e&&t},_displayTypeOnly:function(e,t){return e&&!t},_displayTypeAndExample:function(e,t){return e&&t},_parametersTableHidden:function(e,t){return!!e||!t}});</script>
</dom-module>
</body></html>