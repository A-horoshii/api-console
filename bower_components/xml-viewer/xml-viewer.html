<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../text-search-behavior/text-search-behavior.html">
<link rel="import" href="../paper-spinner/paper-spinner.html">

<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../arc-icons/arc-icons.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../error-message/error-message.html">

</head><body><dom-module id="xml-viewer">
  <template>
    <style>
     :host {
      display: block;
      color: black;
      cursor: text;
      -webkit-user-select: text;
      user-select: text;
      overflow: auto;
      word-wrap: break-word;
      @apply(--xml-viewer);
    }

    .material-icons {
      font-family: 'Material Icons';
      font-weight: normal;
      font-style: normal;
      font-size: 24px;
      /* Preferred icon size */
      display: inline-block;
      line-height: 1;
      text-transform: none;
      letter-spacing: normal;
      word-wrap: normal;
      white-space: nowrap;
      direction: ltr;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
      -moz-osx-font-smoothing: grayscale;
    }

    .prettyPrint {
      font-family: monospace;
      font-size: 15px;
    }

    .arrowEmpty {}

    .node {
      margin: 1px 0px;
    }

    .opened {}

    .comment {
      color: var(--xml-viewer-comment-color, #236E25);
    }

    .punctuation {
      color: var(--xml-viewer-punctuation-color, black);
    }

    .tagname {
      color: var(--xml-viewer-tag-name-color, #881280);
    }

    .attname {
      color: var(--xml-viewer-attribute-name-color, #994500);
    }

    .attribute {
      color: var(--xml-viewer-attribute-value-color, #1A1AA6);
    }

    .cdata {
      color: var(--xml-viewer-cdata-color, #48A);
    }

    .cdata *[collapsible] {
      white-space: pre;
    }

    .arrowExpanded,
    .arrowEmpty {
      display: inline-block;
      width: 24px;
      height: 18px;
    }

    .processing {
      color: var(--xml-viewer-document-declaration-color, #999);
    }

    .inline,
    .inline > div {
      display: inline-block;
      text-indent: 0px;
    }

    .node.opened >. arrowEmpty {
      text-indent: 0;
      font-size: 10px;
      letter-spacing: 0.1em;
      width: 21px;
      margin-left: 3px;
      margin-right: 3px;
    }

    .nodeMargin {
      margin-left: 44px;
    }

    .collapseIndicator {
      display: none;
      margin: 0px 1px;
      text-indent: 0px;
    }

    *[colapse-marker] {
      -webkit-user-select: none;
      cursor: pointer;
    }

    *[less] {
      display: inline-block;
    }

    *[more] {
      display: none;
    }

    *[data-expanded="false"] .arrowEmpty {
      display: none;
    }

    *[data-expanded="false"] *[less] {
      display: none;
    }

    *[data-expanded="false"] *[more] {
      display: inline-block;
    }

    *[data-expanded="false"] *[collapsible] {
      display: none !important;
    }

    *[data-expanded="false"] *[collapse-indicator] {
      display: inline-block !important;
    }

    .value.number,
    .value.null,
    .value.boolean {
      color: var(--xml-viewer-constant-color, #283593);
    }

    .arc-search-mark.selected {
      background-color: #ff9632;
    }

    .actions-panel {
      @apply(--layout-horizontal);
      @apply(--layout-center);
      @apply(--response-highlighter-action-bar);
    }

    .actions-panel.hidden {
      display: none;
    }
    </style>
    <div class$="[[_computeActionsPanelClass(showOutput)]]">
      <content select="[content-action]"></content>
    </div>
    <paper-spinner active="[[working]]"></paper-spinner>
    <error-message hidden$="[[!isError]]">
      <p>There was an error parsing XML data</p>
      <p>[[errorMessage]]</p>
    </error-message>
    <output id="output" hidden$="[[!showOutput]]" on-tap="_handleDisplayClick"></output>
  </template>
  <script>!function(){"use strict";var r="";!function(){var e;if(window.currentImport&&window.currentImport.URL?(e=window.currentImport.URL,window.currentImport._URL&&(e=window.currentImport._URL)):e=window.currentImport._URL?window.currentImport._URL:window.location.href,"about:blank"===e)r="../";else{var t=e.substr(e.indexOf("/",8));t=t.substr(0,t.lastIndexOf("/")+1),-1===t.indexOf("/test")&&-1===t.indexOf("/demo")||(t=t.substr(0,t.length-1),t=t.substr(0,t.lastIndexOf("/")+1)),r=t}}(),Polymer({is:"xml-viewer",properties:{xml:{type:Object,observer:"_changed"},isError:{type:Boolean,readOnly:!0,value:!1,notify:!0},working:{type:Boolean,readOnly:!0,value:!1,notify:!0},showOutput:{type:Boolean,readOnly:!0,value:!1,computed:"_computeShowOutput(working, isError, xml)"},errorMessage:{type:String,readOnly:!0},_worker:Object,_workerDataHandler:{type:Function,value:function(){return this._workerData.bind(this)}},_workerErrorHandler:{type:Function,value:function(){return this._workerError.bind(this)}},_textSearch:{type:HTMLElement,value:function(){return this.$.output}},query:{type:String,observer:"_queryChanged"},importLocation:{type:String,value:function(){return r}}},behaviors:[ArcBehaviors.TextSearchBehavior],detached:function(){this._worker&&(this._worker.removeEventListener("message",this._workerDataHandler),this._worker.removeEventListener("error",this._workerErrorHandler),this._worker=void 0)},_changed:function(){if(this.xml){if(this._setWorking(!0),this._setIsError(!1),this._setErrorMessage(null),this.$.output.innerText="",!this._worker){var r=new Worker(this.importLocation+"/workers/xmlviewer.js");r.addEventListener("message",this._workerDataHandler),r.addEventListener("error",this._workerErrorHandler),this._worker=r}this._worker.postMessage({xml:this.xml,cssPrefix:this.nodeName.toLowerCase()+" style-scope "})}},_workerData:function(r){this._setWorking(!1),this.$.output.innerHTML=r.data},_workerError:function(r){this._setIsError(!0),this._setWorking(!1);var e=r.message.replace("Uncaught Error: ","");e&&this._setErrorMessage(e)},_computeShowOutput:function(r,e,t){return!r&&!e&&!!t},_handleDisplayClick:function(r){if(r.target){var e=r.target;if(e.getAttribute("colapse-marker")||(e=e.parentNode)&&e.getAttribute("colapse-marker")){e=e.parentNode;var t=e.dataset.expanded;e.dataset.expanded=t&&"true"!==t?"true":"false"}}},_queryChanged:function(r){if(!r)return void this.cleanMarked();this.mark(r)},_computeActionsPanelClass:function(r){var e="actions-panel";return r||(e+=" hidden"),e}})}();</script>
</dom-module>
</body></html>