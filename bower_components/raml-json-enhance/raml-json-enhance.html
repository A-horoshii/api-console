<html><head><link rel="import" href="../polymer/polymer.html">

<script>!function(){"use strict";var r="";!function(){var e;if(window.currentImport&&window.currentImport.URL?(e=window.currentImport.URL,window.currentImport._URL&&(e=window.currentImport._URL)):e=window.currentImport._URL?window.currentImport._URL:window.location.href,"about:blank"===e)r="../";else{var n=e.substr(e.indexOf("/",8));n=n.substr(0,n.lastIndexOf("/")+1),n.indexOf("/test")===-1&&n.indexOf("/demo")===-1||(n=n.substr(0,n.length-1),n=n.substr(0,n.lastIndexOf("/")+1)),r=n}}(),Polymer({is:"raml-json-enhance",properties:{json:{type:Object,observer:"_jsonChnaged"},result:{type:Object,notify:!0,readOnly:!0},importLocation:{type:String,value:function(){return r}},_workerExpandDataHandler:{type:Function,value:function(){return this._expandWorkerData.bind(this)}},_workerExpandErrorHandler:{type:Function,value:function(){return this._expandWorkerError.bind(this)}},debug:Boolean,_expadndWorker:Object},_markTime:function(r){this.debug&&performance&&performance.mark&&performance.mark(r)},_jsonChnaged:function(r){return r?(r.specification&&(r=r.specification),void this._normalizeRamlJson(r)):this._setResult(void 0)},_normalizeRamlJson:function(r){if(!this._expadndWorker){var e=new Worker(this.importLocation+"raml-object-worker.js");e.addEventListener("message",this._workerExpandDataHandler),e.addEventListener("error",this._workerExpandErrorHandler),this._expadndWorker=e}this._markTime("raml-worker-expansion-library-send"),this._expadndWorker.postMessage({raml:r})},_expandWorkerData:function(r){this._markTime("raml-worker-expansion-library-receive");var e=r.data;if(e.error)return console.log("Error in the worker.",e),void this.fire("error",{message:e.message});var n=e.result;this._setResult(n),this.fire("raml-json-enhance-ready",{json:n}),this._measureData()},_expandWorkerError:function(r){this._markTime("raml-worker-expansion-library-receive");var e=new Error(r.message||" Unknown worker error.");console.log("Error in the worker.",e),this.fire("error",{message:e.message})},_measureData:function(){if(this.debug&&performance&&performance.mark){performance.measure("worker-work-time","raml-worker-expansion-library-send","raml-worker-expansion-library-receive");var r=performance.getEntriesByType("measure");console.log(r)}}})}();</script>
</head><body></body></html>