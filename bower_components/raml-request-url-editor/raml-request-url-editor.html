<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-input/paper-input-container.html">
<link rel="import" href="../paper-input/paper-input-behavior.html">
<link rel="import" href="../paper-input/paper-input-error.html">
<link rel="import" href="../iron-form-element-behavior/iron-form-element-behavior.html">
<link rel="import" href="../marked-element/marked-element.html">
<link rel="import" href="../markdown-styles/markdown-styles.html">
<link rel="import" href="../paper-styles/typography.html">

<link rel="import" href="url-input.html">


</head><body><dom-module id="raml-request-url-editor">
  <template>
    <style include="markdown-styles"></style>
    <style>
    :host {
      outline: none;
      display: block;
      @apply(--raml-request-url-editor);
    }

    .markdown-body {
      @apply(--paper-font-body1);
      margin-top: 12px;
      color: rgba(0, 0, 0, 0.54);
      @apply(--raml-request-url-editor-documentation);
    }

    </style>
    <paper-input-container no-label-float="[[noLabelFloat]]" attr-for-value="url" always-float-label="[[alwaysFloatLabel]]" disabled$="[[disabled]]" invalid="[[invalid]]">
      <label hidden$="[[!label]]">[[label]]</label>
      <url-input id="input" class="paper-input-input" aria-label-prefix="[[_ariaLabelledBy]]" url="{{value}}" invalid="{{invalid}}" disabled$="[[disabled]]" required$="[[required]]" autofocus$="[[autofocus]]" readonly$="[[readonly]]" type="url"></url-input>
      <template is="dom-if" if="[[errorMessage]]">
        <paper-input-error>[[errorMessage]]</paper-input-error>
      </template>
    </paper-input-container>
    <template is="dom-if" if="[[documentation]]">
      <marked-element markdown="[[documentation]]">
        <div class="markdown-html markdown-body"></div>
      </marked-element>
    </template>
  </template>
  <script>Polymer({is:"raml-request-url-editor",behaviors:[Polymer.PaperInputBehavior,Polymer.IronFormElementBehavior],properties:{uriParameters:Array,url:{type:String,observer:"_onUrlChanged"},label:{type:String,value:"Request URL"},value:{type:String,notify:!0,observer:"_onValueChanged"},errorMessage:{type:String,value:"Fill the URI parameters before making the request"},documentation:{type:String,value:""},skipDocs:Boolean},observers:["_onFocusedChanged(focused)"],listeners:{"variable-click":"_onVariableSelected",blur:"_onElementBlur"},hostAttributes:{tabindex:-1,focusable:!0},ready:function(){this._ready=!0,this.value&&this._handleAutoValidate()},attached:function(){this._eventTarget=Polymer.dom(this).host||document,this.listen(this._eventTarget,"url-value-changed","_extValueChangedHandler")},detached:function(){this._eventTarget&&this.unlisten(this._eventTarget,"url-value-changed","_extValueChangedHandler")},validate:function(){return this.$.input.validate()},_onValueChanged:function(){this._ready&&(this.fire("url-value-changed",{value:this.value}),this._handleAutoValidate())},_onFocusedChanged:function(e){this.debounce("focus",function(){e||this._handleAutoValidate()},20)},_onUrlChanged:function(e,t){e===t&&void 0!==e||this.set("value",e)},_onVariableSelected:function(e,t){e.stopPropagation();var a=t.variable;this._displayVariableDoc(a)},_displayVariableDoc:function(e){if(!this.skipDocs){var t=this.uriParameters;if(!e||!t)return void(this.documentation="");for(var a,i=0,n=t.length;i<n;i++)if(t[i].name===e){a=t[i];break}a&&a.description&&(this.documentation=a.description)}},_onElementBlur:function(){this.documentation=""},_extValueChangedHandler:function(e){e.target!==this&&this.set("value",e.detail.value)}});</script>
</dom-module>
</body></html>