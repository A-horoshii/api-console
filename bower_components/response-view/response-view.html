<html><head><link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../promise-polyfill/promise-polyfill-lite.html">
<link rel="import" href="../fetch-polyfill/fetch-polyfill.html">
<link rel="import" href="../response-status-view/response-status-view.html">
<link rel="import" href="../response-error-view/response-error-view.html">
<link rel="import" href="../response-body-view/response-body-view.html">


</head><body><dom-module id="response-view">
  <template>
    <style>
    :host {
      display: block;
      @apply(--response-view);
    }

    .empty-info {
      @apply(--no-info-message);
    }
    </style>
    <response-status-view status-code="[[statusCode]]" status-message="[[statusMessage]]" request-headers="[[requestHeaders]]" response-headers="[[responseHeaders]]" loading-time="[[loadingTime]]" http-message="[[sentHttpMessage]]" redirects="[[redirects]]" redirect-timings="[[redirectTimings]]" timings="[[responseTimings]]" is-xhr="[[isXhr]]"></response-status-view>
    <template is="dom-if" if="[[hasResponse]]">
      <template is="dom-if" if="[[!isError]]">
        <response-body-view response-text="[[responseBody]]" content-type="[[contentType]]"></response-body-view>
      </template>
      <template is="dom-if" if="[[isError]]">
        <response-error-view message="[[responseError.message]]"></response-error-view>
      </template>
    </template>
    <template is="dom-if" if="[[!hasResponse]]">
      <p class="empty-info">This response does not carry a payload.</p>
    </template>
  </template>
  <script>Polymer({is:"response-view",properties:{response:{type:Response,observer:"_responseChanged"},request:{type:Request,observer:"_requestChanged"},responseError:Object,responseBody:{type:String,notify:!0},statusCode:Number,statusMessage:String,requestHeaders:String,responseHeaders:String,contentType:String,responseTimings:Object,loadingTime:Number,sentHttpMessage:String,redirects:Array,redirectTimings:Array,hasResponse:{type:Boolean,value:!1,computed:"_computeHasResponse(request)"},isError:{type:Boolean,value:!1,computed:"_computeIsError(responseError)"},isXhr:{type:Boolean,value:!1}},_reset:function(){this.set("statusCode",void 0),this.set("statusMessage",void 0),this.set("responseHeaders",void 0),this.set("responseBody",void 0),this.set("contentType",void 0)},_responseChanged:function(e){if(this._reset(),e){this.set("statusCode",e.status),this.set("statusMessage",e.statusText);var s=e.headers,t="";s.forEach(function(e,s){t&&(t+="\n"),t+=s+": "+e}),this.set("responseHeaders",t);var r=this;e.text().then(function(e){r.set("responseBody",e),r.set("contentType",s.get("content-type"))}).catch(function(e){r.fire("app-log",{level:"error",message:e})})}},_resetRequestData:function(){this.set("requestHeaders",void 0),this.set("sentHttpMessage",void 0)},_requestChanged:function(e){if(this._resetRequestData(),e){var s=e.headers,t="";if(s.forEach(function(e,s){t&&(t+="\n"),t+=s+": "+e}),this.set("requestHeaders",t),e.rawMessage)return void this.set("sentHttpMessage",e.rawMessage);var r=this;e.text().then(function(e){r.set("sentHttpMessage",e)}).catch(function(e){r.fire("app-log",{level:"error",message:e})})}},_computeHasResponse:function(e){return!e||"HEAD"!==e.method},_computeIsError:function(e){return!!e}});</script>
</dom-module>
</body></html>