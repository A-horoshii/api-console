<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="request-timings.html">

</head><body><dom-module id="request-timings-panel">
  <template>
    <style>
     :host {
      display: block;
      @spply(--request-timings-panel);
    }

    .status-row,
    .timings-row {
      @apply(--layout-horizontal);
      @apply(--layout-center);
      min-height: 56px;
    }

    .status-row {
      @apply(--layout-horizontal);
      @apply(--layout-end-justified);
    }

    .sub-title {
      @apply(--arc-font-subhead);
    }

    .status-label {
      width: 60px;
      font-size: var(--request-timings-panel-timing-total-size, 16px);
      font-weight: var(--request-timings-panel-timing-total-weigth, 400);
      @apply(--arc-font-subhead);
    }

    .text {
      -webkit-user-select: text;
      cursor: text;
    }

    .redirect-value {
      margin-top: 12px;
      @apply(--layout-flex);
    }
    </style>
    <template is="dom-if" if="[[hasRedirects]]" restamp="">
      <h3 class="sub-title">Redirects</h3>
      <template is="dom-repeat" items="[[redirects]]">
        <div class="timings-row">
          <div class="status-label text">
            #<span>{{_computeIndexName(index)}}</span>
          </div>
          <div class="redirect-value">
            <request-timings timings="[[item]]"></request-timings>
          </div>
        </div>
      </template>
      <template is="dom-if" if="[[hasTimings]]">
        <h3 class="sub-title">Final request</h3>
        <div class="timings-row">
          <div class="redirect-value">
            <request-timings timings="[[timings]]"></request-timings>
          </div>
        </div>
      </template>
      <div class="status-row">
        <div class="flex"></div>
        <span class="timing-value total text">[[requestTotalTime]] ms</span>
      </div>
    </template>
    <template is="dom-if" if="[[!hasRedirects]]" restamp="">
      <request-timings timings="[[timings]]"></request-timings>
    </template>
  </template>
  <script>Polymer({is:"request-timings-panel",properties:{hasRedirects:{type:Boolean,value:!1,readOnly:!0},hasTimings:{type:Boolean,value:!1,readOnly:!0},redirects:{type:Array,value:function(){return[]}},timings:{type:Object,value:function(){return{}}},requestTotalTime:{type:Number,value:0,readOnly:!0}},observers:["_redirectsChanged(redirects.*)","_timingsChanged(timings.*)","_computeRequestTime(redirects.*)","_computeRequestTime(timings.*)"],_redirectsChanged:function(){var e=this.redirects;e&&e.length?this._setHasRedirects(!0):this._setHasRedirects(!1)},_timingsChanged:function(){this.timings?this._setHasTimings(!0):this._setHasTimings(!1)},_computeIndexName:function(e){return e+1},_computeRequestTime:function(){var e=this.redirects,t=this.timings,i=0;e&&e.length&&e.forEach(function(e){i+=this._computeHarTime(e)},this);var r=this._computeHarTime(t);r&&(i+=r),i=Math.round(1e4*i)/1e4,this._setRequestTotalTime(i)},_computeHarTime:function(e){var t=0;if(!e)return t;var i=Number(e.connect),r=Number(e.receive),s=Number(e.send),n=Number(e.wait),u=Number(e.blocked),a=Number(e.dns),m=Number(e.ssl);return(i!==i||i<0)&&(i=0),(r!==r||r<0)&&(r=0),(s!==s||s<0)&&(s=0),(n!==n||n<0)&&(n=0),(a!==a||a<0)&&(a=-1),(u!==u||u<0)&&(u=-1),(m!==m||m<0)&&(m=-1),t+=i+r+s+n,a>0&&(t+=a),u>0&&(t+=u),m>0&&(t+=m),t}});</script>
</dom-module>
</body></html>