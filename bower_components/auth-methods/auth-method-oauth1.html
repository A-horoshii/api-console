<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-masked-input/paper-masked-input.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../arc-icons/arc-icons.html">
<link rel="import" href="../paper-styles/paper-styles.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../iron-form/iron-form.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-toast/paper-toast.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../oauth2-scope-selector/oauth2-scope-selector.html">
<link rel="import" href="../paper-spinner/paper-spinner.html">
<link rel="import" href="auth-methods-behavior.html">

</head><body><dom-module id="auth-method-oauth1">
  <template>
    <style>
    :host {
      display: block;
      @apply(--auth-method-panel);
      @apply(--auth-method-oauth1);

      --paper-icon-button: {
        color: var(--hint-trigger-color, rgba(0, 0, 0, 0.54));
        transition: color 0.25s linear;
        @apply(--icon-button);
      }

      --paper-icon-button-hover: {
        color: var(--hint-trigger-hover-color, rgba(0, 0, 0, 0.78));
        @apply(--icon-button-hover);
      }

      --paper-input-container-focus-color: {
        @apply(--input-line-color);
      }
    }

    paper-input,
    paper-masked-input {
      max-width: 700px;
    }

    .hints .hint {
      display: none;
      color: rgba(0, 0, 0, 0.54);
    }

    .hints .hint[active] {
      display: block;
    }

    .form-panel {
      @apply(--layout-horizontal);
    }

    .form {
      @apply(--layout-flex);
      max-width: 700px;
    }

    .hints {
      margin-left: 0;
      padding-left: 0;
      border-left: 1px rgba(0,0,0,0) solid;
      max-width: 300px;
      width: 0;
      @apply(--paper-font-body1);
      transition: width 0.35s linear, margin 0.2s linear, padding 0.2s linear, border-color 0.15s linear;
      overflow: hidden;
    }

    .hints.active {
      width: 100%;
      margin-left: 16px;
      padding-left: 16px;
      border-left-color: rgba(0,0,0,0.12);
      overflow: auto;
    }

    oauth2-scope-selector {
      margin: 24px 0;
    }

    .grant-dropdown {
      width: 320px;
    }

    .auth-button {
      background-color: var(--primary-color);
      color: rgba(255, 255, 255, 0.87);
    }

    .auth-button[disabled] {
      background-color: rgba(0, 0, 0, 0.24);
      color: rgba(0, 0, 0, 0.54);
    }

    .authorize-actions {
      margin-top: 12px;
    }

    .read-only-param-field {
      padding: 12px;
      background-color: rgba(0, 0, 0, 0.12);
      @apply(--paper-font-body1);
      display: block;
      white-space: pre-wrap;
      word-wrap: break-word;
      word-break: break-all;
    }

    .current-token {
      margin-top: 24px;
    }

    .top-line {
      @apply(--layout-horizontal);
      @apply(--layout-center);
    }

    .enable-container {
      @apply(--layout-flex);
    }

    label {
      @apply(--form-label);
    }

    </style>

    <div class="form-panel">
      <div class="form">
        <form is="iron-form" id="form">

          <paper-masked-input auto-validate="" required="" label="Consumer key" value="{{consumeKey}}" data-field="consumeKey" on-focus="_activateHint" on-blur="_deactivateHint" on-mouseover="_activateHint" on-mouseout="_deactivateHint" autocomplete="on"></paper-masked-input>
          <paper-masked-input label="Consumer secret" value="{{consumerSecret}}" data-field="consumerSecret" on-focus="_activateHint" on-blur="_deactivateHint" on-mouseover="_activateHint" on-mouseout="_deactivateHint" autocomplete="on"></paper-masked-input>
          <paper-masked-input auto-validate="" required="" label="Token" value="{{token}}" data-field="token" on-focus="_activateHint" on-blur="_deactivateHint" on-mouseover="_activateHint" on-mouseout="_deactivateHint" autocomplete="on"></paper-masked-input>
          <paper-masked-input label="Token secret" value="{{tokenSecret}}" data-field="tokenSecret" on-focus="_activateHint" on-blur="_deactivateHint" on-mouseover="_activateHint" on-mouseout="_deactivateHint" autocomplete="on"></paper-masked-input>

          <paper-input auto-validate="" required="" label="Timestamp" value="{{timestamp}}" type="text" data-field="timestamp" on-focus="_activateHint" on-blur="_deactivateHint" on-mouseover="_activateHint" on-mouseout="_deactivateHint" autocomplete="on">
            <paper-icon-button suffix="" on-tap="_genTimestamp" icon="arc:cached" alt="Regenerate input icon" title="Regenerate timestamp"></paper-icon-button>
            <paper-icon-button suffix="" on-tap="_clearField" icon="arc:clear" alt="Clear input icon" title="Clear input"></paper-icon-button>
          </paper-input>

          <paper-input auto-validate="" required="" label="Nonce" value="{{nonce}}" type="text" data-field="nonce" on-focus="_activateHint" on-blur="_deactivateHint" on-mouseover="_activateHint" on-mouseout="_deactivateHint" autocomplete="on">
            <paper-icon-button suffix="" on-tap="_genNonce" icon="arc:cached" alt="Regenerate input icon" title="Regenerate nonce"></paper-icon-button>
            <paper-icon-button suffix="" on-tap="_clearField" icon="arc:clear" alt="Clear input icon" title="Clear input"></paper-icon-button>
          </paper-input>

          <paper-input label="Realm" value="{{realm}}" type="text" data-field="realm" on-focus="_activateHint" on-blur="_deactivateHint" on-mouseover="_activateHint" on-mouseout="_deactivateHint" autocomplete="on"></paper-input>

          <paper-dropdown-menu label="Signature method" class="grant-dropdown" required="" auto-validate="">
            <paper-listbox class="dropdown-content" selected="{{signatureMethod}}" attr-for-selected="data-type">
              <paper-item data-type="HMAC-SHA256">HMAC-SHA256</paper-item>
              <paper-item data-type="HMAC-SHA1">HMAC-SHA1</paper-item>
              <paper-item data-type="PLAINTEXT">PLAINTEXT</paper-item>
            </paper-listbox>
          </paper-dropdown-menu>

          <div class="authorize-actions">
            <paper-button disabled$="[[_authorizing]]" class="auth-button" on-tap="authorize">Authorize</paper-button>
            <paper-spinner active="[[_authorizing]]"></paper-spinner>
          </div>

          <div class="current-token" hidden$="[[!signatureValue]]">
            <label>Current signature</label>
            <p class="read-only-param-field">[[signatureValue]]</p>
          </div>
        </form>
      </div>
      <div class$="[[_computeHintsClass(hintsEnabled)]]">
        <p class="hint" field="consumeKey">The consumer key identifies which application is making the request. It can be found in your provider's API console.</p>
        <p class="hint" field="consumerSecret">The consumer secret is generated by your provider unique string for your app. Check provider's console to get the code.</p>
        <p class="hint" field="token">The token typically represents a userâ€™s permission to share access to their account with your application. You can typically generate the token in your provider's API console.</p>
        <p class="hint" field="tokenSecret">A secret used by the application to establish ownership of a given Token. As stored by the Service Provider.</p>
        <p class="hint" field="timestamp">The timestamp parameter indicates when the request was created. This value should be the number of seconds since the Unix epoch at the point the request is generated, and should be easily generated in most programming languages.</p>
        <p class="hint" field="nonce">The nonce is a unique token your application should generate for each unique request. It was autogenerated when you've opened this form.</p>
        <p class="hint" field="realm"></p>
      </div>
    </div>
    <paper-toast text="" duration="5000"></paper-toast>
  </template>
  <script>Polymer({is:"auth-method-oauth1",behaviors:[ArcBehaviors.AuthMethodsBehavior],properties:{consumeKey:{type:String,notify:!0},consumerSecret:{type:String,notify:!0},token:{type:String,notify:!0},tokenSecret:{type:String,notify:!0},timestamp:{type:Number,notify:!0},nonce:{type:String,notify:!0},realm:{type:String,notify:!0},signatureMethod:{type:String,value:"HMAC-SHA1",notify:!0},signatureValue:{type:String,value:""},hintsEnabled:{type:Boolean,value:!1},_authorizing:Boolean},observers:["_settingsChanged(consumeKey, consumerSecret, token, tokenSecret, timestamp, nonce, realm, signatureMethod)"],attached:function(){this.listen(window,"oauth1-error","_oauth1ErrorHandler")},detached:function(){this.unlisten(window,"oauth1-error","_oauth1ErrorHandler")},ready:function(){this._genTimestamp(),this._genNonce()},get settings(){return this._getSettings()},validate:function(t){return t?this.$.form.checkValidity():this.$.form.validate()},_settingsChanged:function(){var t=this.$.form.validate();if(t){var e=this._getSettings(),n={settings:e,type:"oauth1"};this.fire("auth-settings-changed",n)}},_getSettings:function(){return{consumeKey:this.consumeKey,consumerSecret:this.consumerSecret,token:this.token,tokenSecret:this.tokenSecret,timestamp:this.timestamp,nonce:this.nonce,realm:this.realm,signatureMethod:this.signatureMethod}},_clearField:function(t){t=Polymer.dom(t);for(var e,n=t.path;(e=n.shift())&&"INPUT"!==e.nodeName&&"PAPER-INPUT"!==e.nodeName;);e&&(e.value="")},_activateHint:function(t){if(this.hintsEnabled){var e=this.__getHintField(t);e&&e.setAttribute("active",!0)}},_deactivateHint:function(t){if(this.hintsEnabled){var e=this.__getHintField(t);e&&e.removeAttribute("active")}},__getHintField:function(t){t=Polymer.dom(t);var e=t.localTarget.dataset;if("field"in e){var n=e.field;return Polymer.dom(this.root).querySelector('.hint[field="'+n+'"]')}},_computeHintsClass:function(t){var e="hints";return t&&(e+=" active"),e},_toggleHints:function(){this.hintsEnabled=!this.hintsEnabled},authorize:function(){var t={};this.consumeKey&&(t.consumeKey=this.consumeKey),this.consumeKey&&(t.consumeKey=this.consumeKey),this.consumerSecret&&(t.consumerSecret=this.consumerSecret),this.token&&(t.token=this.token),this.tokenSecret&&(t.tokenSecret=this.tokenSecret),this.timestamp&&(t.timestamp=this.timestamp),this.nonce&&(t.nonce=this.nonce),this.realm&&(t.realm=this.realm),this.signatureMethod&&(t.signatureMethod=this.signatureMethod),this.fire("oauth1-token-requested",t)},_oauth1ErrorHandler:function(t,e){this._authorizing=!1;var n=this.$$("paper-toast");n.text=e.message,n.opened=!0},_genTimestamp:function(){var t=Math.floor(Date.now()/1e3);this.timestamp=t},_genNonce:function(t){var e=[],n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i=n.length;t=Number(t||32),t!==t&&(t=32);for(var o=0;o<t;o++)e[e.length]=n[Math.floor(Math.random()*i)];this.nonce=e.join("")}});</script>
</dom-module>
</body></html>