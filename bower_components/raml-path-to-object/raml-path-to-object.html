<html><head><link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../raml-behaviors/raml-behavior.html">
<link rel="import" href="../raml-aware/raml-aware.html">


</head><body><dom-module id="raml-path-to-object">
  <template>
    <style>
    :host {
      display: none;
    }
    </style>
    <template is="dom-if" if="[[aware]]" restamp="true">
      <raml-aware raml="{{raml}}" scope="[[aware]]"></raml-aware>
    </template>
  </template>
<script>Polymer({is:"raml-path-to-object",behaviors:[Polymer.RamlBehavior],properties:{selectedPath:String,selectedObject:{type:Object,notify:!0,readOnly:!0},selectedParent:{type:Object,notify:!0,readOnly:!0},isMethod:{type:Boolean,value:!1,notify:!0,readOnly:!0},isResource:{type:Boolean,value:!1,notify:!0,readOnly:!0},isDocumentation:{type:Boolean,value:!1,notify:!0,readOnly:!0},isSummary:{type:Boolean,readOnly:!0,notify:!0,value:!1},isType:{type:Boolean,readOnly:!0,notify:!0,value:!1},aware:String,auto:{type:Boolean,value:!1,observer:"_autoChanged"}},observers:["_ramlChanged(raml.*)","_pathChanged(selectedPath, raml)","_fireSelectedObject(selectedObject.*)","_fireSelectedParent(selectedParent.*)","_fireIsMethodState(isMethod)","_fireIsResourceState(isResource)","_fireIsDocumentationState(isDocumentation)","_fireIsSummaryState(isSummary)","_fireIsTypeState(isType)"],attached:function(){this._eventTarget=Polymer.dom(this).host||document,this._autoChanged(this.auto)},_autoChanged:function(e){e?this._attacheListeners():this._detachListeners()},_attacheListeners:function(){this._eventTarget&&(this._detachListeners(),this.listen(this._eventTarget,"raml-selected-path-changed","_pathChangeHandler"))},_detachListeners:function(){this._eventTarget&&this.unlisten(this._eventTarget,"raml-selected-path-changed","_pathChangeHandler")},_pathChangeHandler:function(e,t){this.set("selectedPath",t.path)},clear:function(){this._setSelectedObject(void 0),this._setIsMethod(!1),this._setIsResource(!1),this._setIsDocumentation(!1),this._setIsSummary(!1),this._setIsType(!1),this._cachedRegexps={}},_ramlChanged:function(){this.clear()},_pathChanged:function(e,t){if(!t||!e)return this.clear();this._analysePath(e);var s=this._computeObject(e);return s?(this._setSelectedObject(s),void this._selectParent(e)):this.clear()},_analysePath:function(e){var t;if(e.indexOf(".")!==-1){var s=e.split(".");s.pop(),t=s.pop()}else t=e;var a=!1,i=!1,r=!1,n=!1,h=!1;switch(t){case"resources":r=!0;break;case"methods":a=!0;break;case"documentation":i=!0;break;case"types":n=!0;break;case"summary":h=!0;break;default:return this.clear()}this._setIsMethod(a),this._setIsResource(r),this._setIsDocumentation(i),this._setIsSummary(h),this._setIsType(n)},_selectParent:function(e){if(!(this.isMethod||this.isResource||this.isSummary||this.isType))return this._setSelectedParent(void 0);var t=e.split(".");t.splice(t.length-2,2);var s=t.join(".");if(!s)return this._setSelectedParent(void 0);var a=this.get("raml."+s);return a?void this._setSelectedParent(a):this._setSelectedParent(void 0)},_computeObject:function(e){if(this.isDocumentation)return this.get("raml."+e);if(this.isSummary)return this.raml;{if(!this.isType){var t=this.get("raml."+e);return t}var s=Object.getOwnPropertyNames(this.raml.types),a=e.match(/(\d+)/),i=Number(a[1]);try{return this.raml.types[s[i]]}catch(e){console.error("Unknown type in types list",s[i])}}},_fireSelectedObject:function(){this.fire("raml-selected-object-changed",{selectedObject:this.selectedObject})},_fireSelectedParent:function(){this.fire("raml-selected-parent-changed",{selectedParent:this.selectedParent})},_fireIsMethodState:function(e){this.fire("raml-is-method-changed",{state:e})},_fireIsResourceState:function(e){this.fire("raml-is-resource-changed",{state:e})},_fireIsDocumentationState:function(e){this.fire("raml-is-documentation-changed",{state:e})},_fireIsSummaryState:function(e){this.fire("raml-is-summary-changed",{state:e})},_fireIsTypeState:function(e){this.fire("raml-is-type-changed",{state:e})}});</script>
</dom-module>
</body></html>